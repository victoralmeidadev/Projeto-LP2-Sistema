create database projeto;
use projeto;

CREATE TABLE produto(
id_produto INT NOT NULL AUTO_INCREMENT,
prod_nome VARCHAR(128),
prod_codigo VARCHAR(50),
prod_preco double,
prod_supermercado VARCHAR(128),
PRIMARY KEY(id_produto) );

INSERT INTO produto(prod_nome, prod_codigo, prod_preco, prod_supermercado) VALUES
("Leite 1L", "1111", 2.50, "1");

INSERT INTO produto(prod_nome, prod_codigo, prod_preco, prod_supermercado) VALUES
("Pão Caseiro", "1112", 5.00, "1");

INSERT INTO produto(prod_nome, prod_codigo, prod_preco, prod_supermercado) VALUES
("Bolacha recheada", "1113", 2.00, "1");

INSERT INTO produto(prod_nome, prod_codigo, prod_preco, prod_supermercado) VALUES
("Leite 1L", "1111", 2.30, "2");

INSERT INTO produto(prod_nome, prod_codigo, prod_preco, prod_supermercado) VALUES
("Pão Caseiro", "1112", 5.10, "2");

INSERT INTO produto(prod_nome, prod_codigo, prod_preco, prod_supermercado) VALUES
("Bolacha recheada", "1113", 2.15, "2");

INSERT INTO produto(prod_nome, prod_codigo, prod_preco, prod_supermercado) VALUES
("Leite 1L", "1111", 2.52, "3");

INSERT INTO produto(prod_nome, prod_codigo, prod_preco, prod_supermercado) VALUES
("Pão Caseiro", "1112", 4.99, "3");

INSERT INTO produto(prod_nome, prod_codigo, prod_preco, prod_supermercado) VALUES
("Bolacha recheada", "1113", 1.83, "3");


CREATE TABLE supermercado(
id_supermercado INT NOT NULL AUTO_INCREMENT,
sup_nome VARCHAR(50),
PRIMARY KEY(id_supermercado));

INSERT INTO supermercado(sup_nome) VALUES("Supermercado Bom Preco");

INSERT INTO supermercado(sup_nome) VALUES("Supermercado Mais Barato");

INSERT INTO supermercado(sup_nome) VALUES("Supermercado Baratao");


CREATE TABLE historico(
id_historico INT NOT NULL AUTO_INCREMENT,
his_idProduto VARCHAR(50),
his_idSupermercado INT,
his_data DATE,
his_preco double,
PRIMARY KEY(id_historico));

//teste consulta
select p.prod_nome, s.sup_nome, h.his_preco from produto p, supermercado s, historico h where p.prod_codigo = h.his_idProduto AND s.id_supermercado = h.his_idSupermercado GROUP BY h.id_historico ORDER BY his_data;
//

//
select p.prod_nome, s.sup_nome, AVG(his_preco) as Preco_Medio from produto p, supermercado s, historico h WHERE p.prod_codigo = h.his_idProduto AND s.id_supermercado = h.his_idSupermercado GROUP BY h.his_idProduto, h.his_idSupermercado ORDER BY h.his_data;
//

//
select p.prod_nome, h.his_preco from historico h, produto p, supermercado s where p.prod_codigo = h.his_idProduto and s.id_supermercado = h.his_idSupermercado and h.his_idSupermercado = 1 GROUP BY h.his_idProduto;
//

INSERT INTO historico(his_idProduto, his_idSupermercado, his_data, his_preco) VALUES("1111",1, NOW(), 2.25);
INSERT INTO historico(his_idProduto, his_idSupermercado, his_data,his_preco) VALUES("1111",2, NOW(), 2.20);
INSERT INTO historico(his_idProduto, his_idSupermercado, his_data, his_preco) VALUES("1111",1, NOW(), 2.26);
INSERT INTO historico(his_idProduto, his_idSupermercado, his_data,his_preco) VALUES("1111",2, NOW(), 2.23);
INSERT INTO historico(his_idProduto, his_idSupermercado, his_data, his_preco) VALUES("1111",1, NOW(), 2.30);
INSERT INTO historico(his_idProduto, his_idSupermercado, his_data,his_preco) VALUES("1111",2, NOW(), 2.31);
INSERT INTO historico(his_idProduto, his_idSupermercado, his_data, his_preco) VALUES("1111",1, NOW(), 2.32);
INSERT INTO historico(his_idProduto, his_idSupermercado, his_data,his_preco) VALUES("1111",2, NOW(), 2.33);

INSERT INTO historico(his_idProduto, his_idSupermercado, his_data, his_preco) VALUES("1112",1, NOW(), 2.30);
INSERT INTO historico(his_idProduto, his_idSupermercado, his_data,his_preco) VALUES("1112",2, NOW(), 2.31);
INSERT INTO historico(his_idProduto, his_idSupermercado, his_data, his_preco) VALUES("1112",1, NOW(), 2.32);
INSERT INTO historico(his_idProduto, his_idSupermercado, his_data,his_preco) VALUES("1112",2, NOW(), 2.33);
INSERT INTO historico(his_idProduto, his_idSupermercado, his_data, his_preco) VALUES("1112",1, NOW(), 2.30);
INSERT INTO historico(his_idProduto, his_idSupermercado, his_data,his_preco) VALUES("1112",2, NOW(), 2.31);
INSERT INTO historico(his_idProduto, his_idSupermercado, his_data, his_preco) VALUES("1112",1, NOW(), 2.32);
INSERT INTO historico(his_idProduto, his_idSupermercado, his_data,his_preco) VALUES("1112",2, NOW(), 2.33);


CREATE TABLE listas(
id_lista INT NOT NULL AUTO_INCREMENT,
lis_nome VARCHAR(50),
PRIMARY KEY(id_lista));

INSERT INTO listas(lis_nome) VALUES("Lista de compras da vó");
INSERT INTO listas(lis_nome) VALUES("Lista de compras do tio");

CREATE TABLE produtos_listas(
id_produtolistas INT NOT NULL AUTO_INCREMENT,
pro_lista INT,
pro_nome VARCHAR(50),
pro_idProduto VARCHAR(50),
pro_quantidade INT,
PRIMARY KEY(id_produtolistas));

INSERT INTO produtos_listas(pro_lista, pro_nome, pro_idProduto, pro_quantidade) VALUES (1, "Leite 1L", "1111", 12);
INSERT INTO produtos_listas(pro_lista, pro_nome, pro_idProduto, pro_quantidade) VALUES (2, "Leite 1L", "1111", 4);